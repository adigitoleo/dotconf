#!/bin/sh
#set -euo pipefail
set -eu
readonly SCRIPTNAME="${0##*/}"
usage() { printf 'Usage: %s [-h][-s path]\n' "$SCRIPTNAME"; }
helpf() {
    echo
    echo 'Start dwl as a subprocess of an ssh-agent.'
    echo 'Optionaly run the script at <path> to start other background processes.'
    echo 'Warnings and errors from dwl will be logged to a file in /tmp.'
}
warn() { >&2 printf '%s\n' "${SCRIPTNAME}: $1"; }

LOG="$(mktemp --tmpdir=/tmp dwl-errors-XXXXXX)"
[ $# -eq 0 ] && >/dev/null 2>"$LOG" ssh-agent dwl
while getopts "hs:" OPT ; do
    case "$OPT" in
        s ) >/dev/null 2>"$LOG" ssh-agent dwl -s "$OPTARG" ;;
        h ) usage && helpf ; exit 0 ;;
    esac
done
