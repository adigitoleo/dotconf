#!/bin/bash

# Normal: mocp -Q "%song - %artist"
# Fallback: basename $( mocp -Q "%file")

get_name() {
    SONG=$(mocp -Q %song)

    if [ -n "$SONG" ]; then
        NAME="$SONG - $(mocp -Q %artist)"
    else
        NAME="$(basename "$(mocp -Q %file)")"
    fi
    echo "${NAME%.mp3}"
}

if [ "$(mocp -Q %state)" == "PLAY" ];then
    NAME=$(get_name)
    if [[ ${#NAME} > 30 ]]; then
        printf "%.35s…" "⏸︎  $NAME"
    else
        echo "⏸︎  $NAME"
    fi
elif [ "$(mocp -Q %state)" == "PAUSE" ]; then
    NAME=$(get_name)
    if [[ ${#NAME} > 30 ]]; then
        printf "%.35s…" "⏵︎  $NAME"
    else
        echo "⏵︎  $NAME"
    fi
else
    echo ""
fi
