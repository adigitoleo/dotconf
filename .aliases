# vim:ft=sh
# Shell aliases for bash/zsh.

# --- Prefix rules ---
# a = alsa (audio)
# m = mocp (music)
# d = disk controls (mount/unmount etc.)
# e = elinks (text browser utilities), note that bare `e` should run $EDITOR instead
# p = pacman (package manager)
# v = virtual console
# x = xorg-specific (X11 server)
# c = calendar (e.g. using remind)
# py = python (+ venv, pyenv, ...)
# jl = julia
# rg = ripgrep shortcuts (search)
# mon = wayland monitor configuration (using wlr-randr)


# COLORS AND OUTPUT FORMATTING {{{1
# https://wiki.archlinux.org/index.php/Color_output_in_console

alias colors8='msgcat --color=test|head -11'
alias ls='ls --color=auto --group-directories-first'
alias grep='grep --color=auto'
alias ip='ip --color=auto'
alias lsblk='lsblk -o NAME,MAJ:MIN,RM,SIZE,RO,TYPE,MOUNTPOINT,FSTYPE,FSVER'
alias pacman='pacman --color=auto'
alias tree='tree --dirsfirst'
alias less='less -iR'
alias tmux='TERM=xterm-256color tmux'

# Ignore whatever ripgrep would ignore in the tree output.
alias rg,tree='rg --files | tree --fromfile --dirsfirst'
# rg,glob 'pattern'
alias rg,glob='rg --files -g'
# rg,absglob 'pattern'
alias rg,absglob='rg $PWD --files -g'


# VERSION CONTROL AND SYSTEM ADMIN {{{1

alias p='pacman --color=auto'
alias y=yadm
alias d='diff --color=always -u'
alias p,get='sudo pacman -Syu --color=auto'
alias p,rmsafe='sudo pacman -Rn --color=auto'
alias p,rm='sudo pacman -Rns --color=auto'
alias p,orphans='pacman -Qtdq --color=auto'
alias aur='auracle'
alias pacdiff='sudo SUDO_EDITOR="nvim -d" DIFFPROG="sudoedit" pacdiff'

# Use ED25519 ssh keys by default.
alias ssh-keygen='ssh-keygen -t ed25519'

# Terminal editor.
alias e=$EDITOR

# New terminal instance (same directory).
alias t='1>/dev/null 2>/dev/null setsid $TERM'

# Suspend and lock (run from a vconsole).
alias v,lock='systemctl suspend && vlock --all'

# MISC. ABBREVIATIONS {{{1

# (Un)mount drives, e.g. external usb devices (udisks2).
# Because automounting is not smart enough and always breaks somehow.
alias d,mount='udisksctl mount --options fmask=0133 dmask=0022 noexec -b'
alias d,unmount='sync && udisksctl unmount -b'
alias d,free='lsblk -o NAME,MOUNTPOINT,FSAVAIL'

# Only for X.
alias x,clip='xclip -sel clip'
alias x,op='1>/dev/null 2>/dev/null setsid xdg-open'

# Find and print site urls from elinks history or bookmarks.
alias e,hist='cut -f2 < ~/.elinks/globhist|fzf'
alias e,mark='cut -f2 < ~/.elinks/bookmarks|fzf'

# Print this week's calendar
alias c,day='remind ~/.config/remind/reminders.rem'
alias c,week='remind -c+1 ~/.config/remind/reminders.rem'
alias c,fortnight='remind -c+2 ~/.config/remind/reminders.rem'
alias c,month='remind -c1 ~/.config/remind/reminders.rem'

# Ouroboros and the Virtual Environment.
alias py=python
alias py,venv='python -m venv .venv-${PWD##*/} && source .venv-${PWD##*/}/bin/activate && pip install --upgrade pip pylint jedi jedi-language-server mypy black'
alias py,activate='test -f .venv-${PWD##*/}/bin/activate && source .venv-${PWD##*/}/bin/activate'

# Die Julia
alias jl='julia --banner=no'
alias jl,env='julia --banner=no --project=$PWD'
alias jl,bw='julia --banner=no --color=no'
alias jl,tmp='julia --banner=no --startup-file=no --history-file=no'

# Without music, life would be a mistake.
alias a,mute='amixer set Master toggle'
alias a,mixer=alsamixer
alias m='mocp 2>/dev/null'

# Mon Ã©cran!
alias mon,left='wlr-randr --output HDMI-A-2 --preferred --pos 0,0 --output HDMI-A-1 --preferred --pos -1920,0'
alias mon,right='wlr-randr --output HDMI-A-2 --preferred --pos 0,0 --output HDMI-A-1 --preferred --pos 1920,0'

# Create an archive of <folder>: PATTERN=<folder> && mktar <archive>.tar.gz <folder>
alias mktar='tar --transform=s/$PATTERN/$date +%Y%m%dT%H%M)/ --exclude={__pycache,.mypy_cache} -vcaf'

# Create backup according to ./.BACKUP using rsync: backup <destination>
alias backup='rsync -rszauhP --no-links --delete --files-from=$HOME/.BACKUP .'
